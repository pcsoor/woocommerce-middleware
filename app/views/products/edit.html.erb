<h1 class="text-4xl font-extrabold">Edit Product</h1>

<%= form_with model: @product, method: :put, local: true do |form| %>
  <div>
    <%= form.label :name %><br>
    <%= form.text_field :name, value: @product.name %>
  </div>

  <div>
    <%= form.label :regular_price, "Regular Price" %><br>
    <%= form.number_field :regular_price %>
  </div>

  <div>
    <%= form.label :stock_quantity, "Stock Quantity" %><br>
    <%= form.number_field :stock_quantity %>
  </div>

  <%= form.hidden_field :type, value: "simple" %>
  <%= form.hidden_field :manage_stock, value: true %>

  <div>
    <%= form.submit "Update Product" %>
  </div>
<% end %>

<% if @product.type == "variable" %>
  <h2>Variations</h2>
  <ul>
    <% @variations.each do |variation| %>
      <li>
        <% if variation["attributes"].is_a?(Array) %>
          <strong>
            <%= variation["attributes"].map { |a| a["option"] }.join(" / ") %>
          </strong><br>
        <% else %>
          <strong>No attributes</strong><br>
        <% end %>

        Price: <%= variation["regular_price"] %><br>
        Stock: <%= variation["stock_quantity"] %><br>
        <%= link_to "Edit", edit_product_variation_path(@product.id, variation["id"]) %>
      </li>
    <% end %>

  </ul>
<% end %>

<%= link_to "Back to Products", products_path %>
